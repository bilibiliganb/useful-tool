# 比较文件

linux

```
方法一：使用common命令。

comm命令是一个非常简洁的命令，其只有两个参数。不过三个参数也结常要组合使用，我们常用的用法如下:

comm - 12 就只显示在两个文件中都存在的行；

comm - 23 只显示在第一个文件中出现而未在第二个文件中出现的行；

comm找出文件2中有，文件1中没有的行：

comm -23 2.txt 1.txt

 

注：两个文件的内容在比较前，一定要进行sort排序。不然输出的结果将是错误的。

 

 

方法二：diff命令比较

diff命令是一个比较经典的文本比较工具了，diff命令较comm的参数要多。其经常和patch命令组合使用，进行补丁升级。其默认使用的是-a参数，即逐行比较两个文件之间的不同。此处我们要实现想要得到的结果，还需要配合grep和awk实用：

diff 2.txt 1.txt |grep "<"|awk ' $1 = " " '

注：此处也发现，在使用diff命令进行比较时，也需要预先对经比较的文件进行sort排序，不然输出的结果同样是不正确的。

```





# 去重

```
1、传统方法：cat xx | sort | uniq

  优点：简单直接

  缺点：顺序乱了


ghostwu@dev:~/linux/uniq$ cat ghostwu.txt 
192.168.1.2
192.168.1.8
192.168.1.3
192.168.1.3
192.168.1.9
192.168.1.8
192.168.1.8
192.168.1.0
192.168.1.3
ghostwu@dev:~/linux/uniq$ uniq ghostwu.txt 
192.168.1.2
192.168.1.8
192.168.1.3
192.168.1.9
192.168.1.8
192.168.1.0
192.168.1.3

 

2、awk命令去重输出：awk '!x[$0]++' filename

  应用扩展1：cat Afile Bfile|awk '!x[$0]++' >Cfile

  依次输出A、B两个文件内容，去掉B中与A重复的行，输出到C；多应用于日志拼接。

灵活扩展2：cat Afile|awk '!x[$0]++'

也可以写作：awk '!x[$0]++' Afile

去掉重复的行，输出A文件

 

3、vim通配符：

: sort //可以直接排序，这个太好用了

:g/^.∗.∗$\n\1$/d    //去除重复行

:g/\%(^\1$\n\)\@<=.∗.∗$/d //功能同上，也是去除重复行

:g/\%(^\1\>.*$\n\)\@<=\k\+\k\+.*$/d//功能同上，也是去除重复行

这几条命令我抄的，没用成功，有用成功了的麻烦告诉下，谢谢。





```





```
uniq命令
作用：输出或者忽略文件中的重复行

格式: uniq [option] [file|stdin]

复制代码
ghostwu@dev:~/linux/uniq$ cat ghostwu.txt 
192.168.1.2
192.168.1.8
192.168.1.3
192.168.1.3
192.168.1.9
192.168.1.8
192.168.1.8
192.168.1.0
192.168.1.3
ghostwu@dev:~/linux/uniq$ uniq ghostwu.txt 
192.168.1.2
192.168.1.8
192.168.1.3
192.168.1.9
192.168.1.8
192.168.1.0
192.168.1.3
复制代码
去掉了连续的重复行.如果只想保留文件中的唯一，可以用选项-u

ghostwu@dev:~/linux/uniq$ uniq -u ghostwu.txt 
192.168.1.2
192.168.1.8
192.168.1.9
192.168.1.0
192.168.1.3
-c：去重复，并计算每行出现的次数

复制代码
ghostwu@dev:~/linux/uniq$ uniq -c ghostwu.txt 
      1 192.168.1.2
      1 192.168.1.8
      2 192.168.1.3
      1 192.168.1.9
      2 192.168.1.8
      1 192.168.1.0
      1 192.168.1.3
ghostwu@dev:~/linux/uniq$ cat -n ghostwu.txt 
     1    192.168.1.2
     2    192.168.1.8
     3    192.168.1.3
     4    192.168.1.3
     5    192.168.1.9
     6    192.168.1.8
     7    192.168.1.8
     8    192.168.1.0
     9    192.168.1.3
复制代码
可以用sort命令排序后，再去重复，得到的结果　也是唯一的

ghostwu@dev:~/linux/uniq$ sort -n ghostwu.txt | uniq -c
      1 192.168.1.0
      1 192.168.1.2
      3 192.168.1.3
      3 192.168.1.8
      1 192.168.1.9
-d: 只显示重复的行

ghostwu@dev:~/linux/uniq$ uniq -d ghostwu.txt 
192.168.1.3
192.168.1.8
```

